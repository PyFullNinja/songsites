{% extends "base.html" %}

{% block title %}Купить {{ song.title }}{% endblock %}

{% block content %}
<div class="shop-container">
    <div class="shop-wrapper">
        
        <div class="shop-visual">
            <img src="{{ url_for('static', filename=song.avatar_path.replace('static/', '')) if song.avatar_path else url_for('static', filename='default_cover.png') }}" class="shop-cover">
            <div class="shop-info-header">
                <h1>{{ song.title }}</h1>
                <p class="shop-genre">{{ song.genre }} | {{ song.bpm }} BPM | {{ song.key }}</p>
            </div>
        </div>

        <div class="shop-pricing">
            <h3>ВЫБЕРИТЕ ТИП ЛИЦЕНЗИИ</h3>
            
            <div class="license-list">
                {% if song.price_mp3 %}
                <div class="license-item">
                    <div class="license-info">
                        <span class="license-name">MP3 LEASE</span>
                        <span class="license-details">MP3 файл</span>
                    </div>
                    <a href="{{ url_for('shop.create_payment', song_id=song.id, license_type='mp3') }}" class="buy-now-btn">
                        {{ (song.price_mp3 or 0) | format_price}}
                    </a>
                </div>
                {% endif %}

                {% if song.price_wav %}
                <div class="license-item">
                    <div class="license-info">
                        <span class="license-name">WAV LEASE</span>
                        <span class="license-details">WAV + MP3</span>
                    </div>
                    <a href="{{ url_for('shop.create_payment', song_id=song.id, license_type='wav') }}" class="buy-now-btn">
                        {{ (song.price_wav or 0) | format_price}}
                    </a>
                </div>
                {% endif %}

                {% if song.price_track_out %}
                <div class="license-item">
                    <div class="license-info">
                        <span class="license-name">TRACKOUT</span>
                        <span class="license-details">WAV + Stems (подороже)</span>
                    </div>
                    <a href="{{ url_for('shop.create_payment', song_id=song.id, license_type='trackout') }}" class="buy-now-btn">
                        {{ (song.price_track_out) | format_price }}
                    </a>
                </div>
                {% endif %}

                {% if song.price_exclusive %}
                <div class="license-item highlighted">
                    <div class="license-info">
                        <span class="license-name">EXCLUSIVE</span>
                        <span class="license-details">Полные права на трек</span>
                    </div>
                    <a href="{{ url_for('shop.create_payment', song_id=song.id, license_type='exclusive') }}" class="buy-now-btn">
                        {{ (song.price_exclusive or 0) | format_price }}
                    </a>
                </div>
                {% endif %}
            </div>

            <a href="{{ url_for('main.beats') }}" class="back-link">← Вернуться к списку</a>
        </div>

    </div>
</div>
{% endblock %}